var d=Object.defineProperty;var S=(e,t,r)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var c=(e,t,r)=>S(e,typeof t!="symbol"?t+"":t,r);var a=class extends Error{constructor(r,s){super(r);c(this,"path");this.path=s}},m=class{constructor(t){this.s=t;c(this,"statements");this.statements=t}newRole(t){return new i(t)}},i=class e{constructor(t){c(this,"statements");this.statements=t}authorize(t,r){for(let[s,o]of Object.entries(t)){let n=this.statements[s];if(!n)return{success:!1,error:`You are not allowed to access resource: ${s}`};let l=r==="OR"?o.some(u=>n.includes(u)):o.every(u=>n.includes(u));return l?{success:l}:{success:!1,error:`unauthorized to access resource "${s}"`}}return{success:!1,error:"Not authorized"}}static fromString(t){let r=JSON.parse(t);if(typeof r!="object")throw new a("statements is not an object",".");for(let[s,o]of Object.entries(r)){if(typeof s!="string")throw new a("invalid resource identifier",s);if(!Array.isArray(o))throw new a("actions is not an array",s);for(let n=0;n<o.length;n++)if(typeof o[n]!="string")throw new a("action is not a string",`${s}[${n}]`)}return new e(r)}toString(){return JSON.stringify(this.statements)}};var f=e=>new m(e),x={organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"]},p=f(x),g=p.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"]}),y=p.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"]}),b=p.newRole({organization:[],member:[],invitation:[]}),A={admin:g,owner:y,member:b};var O=e=>i.fromString(e!=null?e:"");export{m as AccessControl,a as ParsingError,i as Role,g as adminAc,f as createAccessControl,p as defaultAc,A as defaultRoles,x as defaultStatements,b as memberAc,y as ownerAc,O as permissionFromString};
